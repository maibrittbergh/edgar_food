---
title: "Descriptive Statistics"
subtitle:  Felix & Mai-Britt , University of Potsdam
date: "15.03 January 2023"
output:
  html_document:
    theme: cosmo
    toc: yes
    toc_float: true
  html_notebook: 
    theme: journal
    toc: true
    toc_float: true
  pdf_document:
    keep_tex: yes
    latex_engine: xelatex
fontsize: 12pt
---

```{r}
library(ggplot2)
library(tidyverse)
library(readr)
```{r}
library(readxl)
require(klaR)
#install.packages("e1071")
library(e1071)
#install.packages("gmodels")
library(gmodels)
#install.packages('caret')
library(caret)

```


## Read in Data 

```{r}
emi = read_excel("EDGAR-FOOD_v6.xlsx", 
    sheet = "GHG FOOD system emi", skip = 3)
shares = read_excel("EDGAR-FOOD_v6.xlsx", 
    sheet = "GHG FOOD system shares", skip = 3)
sector= read_excel("EDGAR-FOOD_v6.xlsx", 
    sheet = "FOOD emi by sector ", skip = 3, na ="NULL")
cd= read_excel("EDGAR-FOOD_v6.xlsx", 
    sheet = "country definition", skip = 3, na ="NULL") 
cd=cd[-which(cd$`Country ISO code`=="NFK"),]

```

## tidy data


```{r}


# we change the structure of the data in a tidyform: called envi to better work on the dataframe

years=c(1990:2018)
countries=emi$Name





envi=c(0,0,0,0,0)


  
 for ( i in 1:length(years)){
   
  
a=rep(years[i], length(countries))
e=emi[,2+i]
c=emi$Name
r=cd$`Regional grouping`
index=cd$`Country class`
k=cbind(a,e,c,r, index)
colnames(k)=c("years", "emissions", "names", "region", "country class")
envi=rbind(envi,k)



 }

  envi$emissions=as.numeric(envi$emissions)
  envi$years=as.numeric(envi$years)
envi=envi[-1,]

```







```{r}

(which(sector$dev_country==0))
sector2=sector[-(which(sector$dev_country==0)),]
ggplot(data=sector2)+geom_col(aes(x=sector2$dev_country, y=sector2$Y_1990, fill=sector2$FOOD_system_stage))
```


```{r}

(which(sector$dev_country==0))
sector2=sector[-(which(sector$dev_country==0)),]
ggplot(data=sector2)+geom_col(aes(x=sector2$C_group_IM24_sh, y=sector2$Y_1990, fill=sector2$FOOD_system_stage))+ theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
```


```{r}

envi2=envi[-(which(envi$`country class`==0)),]
ggplot(data=envi2)+geom_col(aes(x=years, y=envi2$emissions, fill=envi2$`country class`))
```
```



```{r}
head(envi)
ggplot(data=envi)+geom_col(aes(x=years, y=envi$emissions, fill=envi$region))
```

